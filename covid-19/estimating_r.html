<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Louis Rossouw" />


<title>Methodology for Estimating the Effective Reproductive Number of COVID-19</title>

<script src="estimating_r_files/header-attrs-2.8/header-attrs.js"></script>
<script src="estimating_r_files/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="estimating_r_files/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="estimating_r_files/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="estimating_r_files/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="estimating_r_files/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="estimating_r_files/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="estimating_r_files/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="estimating_r_files/tocify-1.9.1/jquery.tocify.js"></script>
<script src="estimating_r_files/navigation-1.1/tabsets.js"></script>
<link href="estimating_r_files/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="estimating_r_files/highlightjs-9.12.0/highlight.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-167980662-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-167980662-1');
  gtag('config', 'G-LKV6CYVD72');
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>




<style type="text/css">
/* for pandoc --citeproc since 2.11 */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>




<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
pre code {
  padding: 0;
}
</style>



<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}

.tocify-subheader {
  display: inline;
}
.tocify-subheader .tocify-item {
  font-size: 0.95em;
}

</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div id="header">



<h1 class="title toc-ignore">Methodology for Estimating the Effective Reproductive Number of COVID-19</h1>
<h4 class="author">Louis Rossouw</h4>
<h4 class="date">2021-05-15 06:28:11 GMT</h4>

</div>


<div id="introduction" class="section level1" number="1">
<h1 number="1"><span class="header-section-number">1</span> Introduction</h1>
<p>This paper describes the methodology for estimating the effective reproductive number <span class="math inline">\(R_{t,m}\)</span> over time <span class="math inline">\(t\)</span> in various countries or provinces <span class="math inline">\(m\)</span>. This is done using the methodology as described in <span class="citation">[1]</span>. These have been implemented in R using <code>EpiEstim</code> package <span class="citation">[2]</span> which is what is used here.</p>
<p>This paper and it’s results should be updated roughly daily and <a href="https://lrossouw.github.io/covid-19/estimating_r.html">is available online</a>.</p>
<p>To view results of this methodology please refer to the following:</p>
<ul>
<li><a href="https://lrossouw.github.io/covid-19/estimating_r_ca.html">Estimating the Effective Reproduction Number of COVID-19 in Canada</a>.</li>
<li><a href="https://lrossouw.github.io/covid-19/estimating_r_za.html">Estimating the Effective Reproduction Number of COVID-19 in South Africa</a>.</li>
<li><a href="https://lrossouw.github.io/covid-19/estimating_r_uk.html">Estimating the Effective Reproduction Number of COVID-19 in United Kingdom</a>.</li>
<li><a href="https://lrossouw.github.io/covid-19/estimating_r_world.html">Estimating the Effective Reproduction Number of COVID-19 by Country</a>.</li>
</ul>
</div>
<div id="updates" class="section level1" number="2">
<h1 number="2"><span class="header-section-number">2</span> Updates</h1>
<p>As this paper is updated over time this section will summarise significant changes. The code producing this paper is tracked using Git. The Git commit hash for this project at the time of generating this paper was ac0db2c77553404b59952ba6367be097409038c9.</p>
<p><strong>2020-06-12</strong></p>
<ul>
<li>Initial version.</li>
</ul>
<p><strong>2020-06-13</strong></p>
<ul>
<li>Combine the version for South Africa and other countries.</li>
</ul>
<p><strong>2020-06-14</strong></p>
<ul>
<li>Add Google Mobility data for comparison and further modelling.</li>
</ul>
<p><strong>2020-06-15</strong></p>
<ul>
<li>Add more details about methodology.</li>
</ul>
<p><strong>2020-06-17</strong></p>
<ul>
<li>Tidy-up to remove the code.</li>
</ul>
<p><strong>2020-10-19</strong></p>
<ul>
<li>Tidy up reports and split out into multiple reports for South Africa and the world.</li>
</ul>
<p><strong>2020-10-29</strong></p>
<ul>
<li>Switch from using a serial interval assumption to a generation interval assumption.</li>
<li>Introduce uncertainty around this assumption.</li>
</ul>
<p><strong>2020-12-27</strong></p>
<ul>
<li>Updated graphics in all reports.</li>
<li>Added risk quadrants.</li>
<li>Switched to an overlapping sliding 7-day window for calculations (instead of distinct 7-day periods).</li>
</ul>
</div>
<div id="method-assumptions" class="section level1" number="3">
<h1 number="3"><span class="header-section-number">3</span> Method &amp; Assumptions</h1>
<p>This analysis follows the follows the method proposed <span class="citation">[1]</span>.</p>
<p>Essentially this models the following relationship:</p>
<p><span class="math inline">\(E(I_{t,m})=R_{t,m}\sum_{s=1}^tI_{t-s,m}w_{s}\)</span> where:</p>
<ul>
<li><span class="math inline">\(m\)</span> is the country or province/state of a country.</li>
<li><span class="math inline">\(I_{t,m}\)</span> is the number of cases (or deaths) reported at time <span class="math inline">\(t\)</span>.</li>
<li><span class="math inline">\(R_{t,m}\)</span> is the “instantaneous reproduction number” to quote <span class="citation">[1]</span>.</li>
<li><span class="math inline">\(I_{t,m} \sim Poisson\)</span> with the above mean.</li>
<li><span class="math inline">\(w_{s}\)</span> is the infectivity profile of an individual over time <span class="math inline">\(s\)</span>.</li>
</ul>
<p>The formulation of instantaneous rate of transmission proposed in <span class="citation">[1]</span> is convenient because it ensures that <span class="math inline">\(R_{t,m}\)</span> only depends on information that is known at time <span class="math inline">\(t\)</span>. We do not need to know about future transmission.</p>
<div id="generation-interval-distribution" class="section level2" number="3.1">
<h2 number="3.1"><span class="header-section-number">3.1</span> Generation interval distribution</h2>
<p>To do further analysis a generation time assumption is needed (<span class="math inline">\(w_{s}\)</span>).</p>
<p>We assume based on the meta-analysis in <span class="citation">[3]</span> that mean of the generation interval is 5.19 and that it is distributed normally with an standard deviation of 0.45. We truncate this distribution at a minimum of 2.19 and a maximum of 7.19. Note that the mean of generation interval is the same as the mean of the serial interval.</p>
<p>Most of the studies included in the meta-analysis measure the standard deviation of the serial interval rather than that of the generation interval. <span class="citation">[4]</span> points out that the generation interval has lower variance than the serial interval distribution and hence the generation interval should be used when estimating <span class="math inline">\(R\)</span>. Using the serial interval introduces bias.</p>
<p>In <span class="citation">[4]</span> the estimates for the standard deviation of the generation time distribution is between 1.75 and 2.29. We assume the mean of the standard deviation is 2 and it’s standard deviation is 0.75. We also assume this parameter is normally distributed and is truncated at a minimum of 1 and a maximum of 4.</p>
<p>We assume that the generation interval itself is Gamma distributed with the above parameters.</p>
</div>
<div id="time-window-size" class="section level2" number="3.2">
<h2 number="3.2"><span class="header-section-number">3.2</span> Time Window Size</h2>
<p><span class="citation">[1]</span> describes a choice of a time window to estimate <span class="math inline">\(R_{t,m}\)</span>. Based on this analysis we chose a time window of 7-days (<span class="math inline">\(\tau\)</span> using notation of <span class="citation">[1]</span>). During this window <span class="math inline">\(R_{t,m}\)</span> is assumed to be constant. However information prior that is taken into account.</p>
<p>Note that the time window size does not interact with the generation interval as information prior to the window is taken into account. It’s just the period during which <span class="math inline">\(R_{t,m}\)</span> is assumed to be constant.</p>
<p>Based on the table in Appendix 2 of <span class="citation">[1]</span> we believe a window of 7-days to be reasonable as long as that window contains 12 or more cases or deaths.</p>
</div>
</div>
<div id="estimating-r_tm" class="section level1" number="4">
<h1 number="4"><span class="header-section-number">4</span> Estimating <span class="math inline">\(R_{t,m}\)</span></h1>
<p>The analysis works backwards and fits <span class="math inline">\(R_{t,m}\)</span> values 7-day periods (ending on the last date in the data) using the <code>EpiEstim</code> package, using an overlapping sliding window.</p>
<p>So <span class="math inline">\(t\)</span> is based on the date of reporting (be that cases or deaths) and <span class="math inline">\(m\)</span> is the country or province. Two values are estimated for each country:</p>
<ol style="list-style-type: decimal">
<li><span class="math inline">\(R_{t,m}^{cases}\)</span> is the reproductive number implied by the cases reported at time <span class="math inline">\(t\)</span> in country <span class="math inline">\(m\)</span>.</li>
<li><span class="math inline">\(R_{t,m}^{deaths}\)</span> is the reproductive number implied by the deaths reported at time <span class="math inline">\(t\)</span> in country <span class="math inline">\(m\)</span>.</li>
</ol>
<p>Note that the time periods are left unadjusted, though in reality the <span class="math inline">\(R_{t,m}^{deaths}\)</span> should be shifted back approximately 2 weeks relative to <span class="math inline">\(R_{t,m}^{cases}\)</span>.</p>
</div>
<div id="discussion" class="section level1" number="5">
<h1 number="5"><span class="header-section-number">5</span> Discussion</h1>
<p>Limitation of this method to estimate <span class="math inline">\(R_{t,m}\)</span> are noted in <span class="citation">[1]</span></p>
<ul>
<li>It’s sensitive to changes in transmissibility, changes in contact patterns, depletion of the susceptible population and control measures.</li>
<li>It relies on an assumed generation interval assumptions.</li>
<li>The size of the time window can affect the volatility of results.</li>
<li>Results are time lagged with regards to true infection, more so in the case of the use of deaths.</li>
<li>It’s sensitive to changes in case (or death) detection.</li>
<li>The generation interval may change over time.</li>
</ul>
<p>Further to the above the estimates are made under assumption that the cases and deaths are reported consistently over time. For cases this means that testing needs to be at similar levels and reported with similar lag. Should these change rapidly over an interval of a few weeks the above estimates of the effective reproduction numbers would be biased. For example a rapid expansion of testing over the last 3 weeks would results in overestimating recent effective reproduction numbers. Similarly any changes in reporting (over time and underreporting) of deaths would also bias estimates of the reproduction number estimated using deaths. It may well be that some catch-up in reported deaths is exaggerating the estimates for October.</p>
<p>Estimates for the reproduction number are plotted in time period in which the relevant measure is recorded. Though in reality the infections giving rise to those estimates would have occurred roughly between a week to 4 weeks earlier depending on whether it was cases or deaths. These figures have not been shifted back.</p>
<p>Despite these limitation we believe the ease of calculation of this method and the ability to use multiple sources makes it useful as a monitoring tool.</p>
</div>
<div id="author" class="section level1" number="6">
<h1 number="6"><span class="header-section-number">6</span> Author</h1>
<p>This report was prepared by Louis Rossouw. Please get in contact with Louis Rossouw if you have comments or wish to receive this regularly.</p>
<p><strong>Louis Rossouw</strong><br />
Head of Research &amp; Analytics<br />
Gen Re | Life/Health Canada, South Africa, Australia, NZ, UK &amp; Ireland<br />
Email: <a href="mailto:LRossouw@genre.com">LRossouw@GenRe.com</a> Mobile: +27 71 355 2550</p>
<p><strong><em>The views in this document represents that of the author and may not represent those of Gen Re. Also note that given the significant uncertainty involved with the parameters, data and methodology care should be taken with these numbers and any use of these numbers.</em></strong></p>
</div>
<div id="references" class="section level1 unnumbered">
<h1 class="unnumbered">References</h1>
<div id="refs" class="references csl-bib-body">
<div id="ref-Cori2013" class="csl-entry">
<div class="csl-left-margin">[1] </div><div class="csl-right-inline">A. Cori, N. M. Ferguson, C. Fraser, and S. Cauchemez, <span>“A new framework and software to estimate time-varying reproduction numbers during epidemics,”</span> <em>American Journal of Epidemiology</em>, vol. 178, no. 9, pp. 1505–1512, Sep. 2013, doi: <a href="https://doi.org/10.1093/aje/kwt133">10.1093/aje/kwt133</a>. [Online]. Available: <a href="https://doi.org/10.1093/aje/kwt133">https://doi.org/10.1093/aje/kwt133</a></div>
</div>
<div id="ref-Cori2013a" class="csl-entry">
<div class="csl-left-margin">[2] </div><div class="csl-right-inline">A. Cori, <em><span>EpiEstim</span>: <span>A</span> package to estimate time varying reproduction numbers from epidemic curves.</em> 2013 [Online]. Available: <a href="https://CRAN.R-project.org/package=EpiEstim">https://CRAN.R-project.org/package=EpiEstim</a></div>
</div>
<div id="ref-Rai2020" class="csl-entry">
<div class="csl-left-margin">[3] </div><div class="csl-right-inline">B. Rai, A. Shukla, and L. K. Dwivedi, <span>“Estimates of serial interval for <span>COVID</span>-19: <span>A</span> systematic review and meta-analysis,”</span> <em>Clinical Epidemiology and Global Health</em>, Aug. 2020, doi: <a href="https://doi.org/10.1016/j.cegh.2020.08.007">10.1016/j.cegh.2020.08.007</a>. [Online]. Available: <a href="http://www.sciencedirect.com/science/article/pii/S2213398420301895">http://www.sciencedirect.com/science/article/pii/S2213398420301895</a>. [Accessed: 29-Oct-2020]</div>
</div>
<div id="ref-Ganyani2020" class="csl-entry">
<div class="csl-left-margin">[4] </div><div class="csl-right-inline">T. Ganyani <em>et al.</em>, <span>“Estimating the generation interval for coronavirus disease (<span>COVID</span>-19) based on symptom onset data, <span>March</span> 2020,”</span> <em>Eurosurveillance</em>, vol. 25, no. 17, p. 2000257, Apr. 2020, doi: <a href="https://doi.org/10.2807/1560-7917.ES.2020.25.17.2000257">10.2807/1560-7917.ES.2020.25.17.2000257</a>. [Online]. Available: <a href="https://www.eurosurveillance.org/content/10.2807/1560-7917.ES.2020.25.17.2000257">https://www.eurosurveillance.org/content/10.2807/1560-7917.ES.2020.25.17.2000257</a>. [Accessed: 29-Oct-2020]</div>
</div>
</div>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = false;
    options.smoothScroll = false;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
